\begin{code}

{-# OPTIONS --prop --rewriting #-}

open Agda.Primitive
open import Equality
open import Logic
open import Nat
open import TTSyntax

module TTStrictifiedSyntax where

-- We can define a more Strict Syntax where most of the equations are definitional

S : DepModel
S = record
  { Conâ€¢   = Î» _ â†’ ğŸ™
  ; Tyâ€¢    = Î» _ â†’ ğŸ™
  ; Subâ€¢   = Î» _ _ _ â†’ ğŸ™
  ; Tmâ€¢    = Î» {Î“} _ {A} _ t â†’ Î£ (âˆ€{Î”} â†’ (Ïƒ : Sub Î” Î“) â†’ Tm Î” A)
                                (Î» t[_]* â†’ (âˆ€{Î”}(Ïƒ : Sub Î” Î“) â†’ Lift ((t[ Ïƒ ]*) â‰¡ t [ Ïƒ ])))
  
  ; â—‹â€¢     = â˜…
  ; _â–·â€¢_   = Î» _ _ â†’ â˜…
  
  ; pâ€¢     = â˜…
  ; âŸ¨_âŸ©â€¢    = Î» _ â†’ â˜…
  ; _âºâ€¢    = Î» _ â†’ â˜…
  
  ; Î¹â€¢     = â˜…
  ; _â‡’â€¢_   = Î» _ _ â†’ â˜…
  
  ; _[_]â€¢  = Î» { {Î“}{_}{Î”}{_}{A}{_}{t} (t[_]* , t[_]*=) {Ïƒ} _ â†’
               (Î» {Î”'} Ïƒ' â†’ t[ Ïƒ ]* [ Ïƒ' ]) ,
               (Î» {Î”'} Ïƒ' â†’ âŸª congâŸ¨ _[ Ïƒ' ] âŸ© (unfold t[ Ïƒ ]*=) âŸ«)}
  ; qâ€¢     = Î» { {Î“}{_}{A}{_} â†’
               (Î» {Î”'} Ïƒ' â†’ q [ Ïƒ' ]) ,
               (Î» {Î”'} Ïƒ' â†’ âŸª refl âŸ«)}
  ; lamâ€¢   = Î» { {Î“}{_}{A}{_}{B}{_}{t} (t[_]* , t[_]*=) â†’
               (Î» {Î”'} Ïƒ' â†’ lam t[ Ïƒ' âº ]*) ,
               (Î» {Î”'} Ïƒ' â†’ âŸª (congâŸ¨ lam âŸ© (unfold t[ Ïƒ' âº ]*=)) â–  (sym lam[]) âŸ«)}
  ; _$â€¢_   = Î» { {Î“}{_}{A}{_}{B}{_}{t} (t[_]* , t[_]*=) {u} (u[_]* , u[_]*=) â†’
               (Î» {Î”'} Ïƒ' â†’ t[ Ïƒ' ]* $ u[ Ïƒ' ]*) ,
               (Î» {Î”'} Ïƒ' â†’ âŸª (congâŸ¨ _$ u[ Ïƒ' ]* âŸ© (unfold t[ Ïƒ' ]*=)) â–  (congâŸ¨ (t [ Ïƒ' ])$_ âŸ© (unfold u[ Ïƒ' ]*=)) â–  (sym $[]) âŸ«)}
  
  ; Î²â€¢     = Î» { {Î“}{_}{A}{_}{B}{_}{t}{t[_]* , t[_]*=}{u}{u[_]* , u[_]*=} â†’
               let Î²[_]*= = (Î» {Î”'' : Con} (Ïƒ'' : Sub Î”'' Î“) â†’
                             âŸª (congâŸ¨ (lam t[ Ïƒ'' âº ]*) $_ âŸ© (unfold u[ Ïƒ'' ]*=)) â– 
                               (congâŸ¨ (Î» x â†’ (lam x) $ (u [ Ïƒ'' ])) âŸ© (unfold t[ Ïƒ'' âº ]*=)) â– 
                               (congâŸ¨ _$ (u [ Ïƒ'' ]) âŸ© (sym lam[])) â– 
                               (sym $[]) âŸ«)
               in
               (funexti Î» Î”' â†’
                funext  Î» Ïƒ' â†’
                (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”}(Ïƒ : Sub Î” Î“) â†’ Lift ((v[ Ïƒ ]*) â‰¡ v [ Ïƒ ]))}
                                         (Î² {Î“}{A}{B}{t}{u})
                                         {(Î» {Î”} (Ïƒ : Sub Î” Î“) â†’ lam t[ Ïƒ âº ]* $ u[ Ïƒ ]*) , Î²[_]*=}) Î”') Ïƒ') â–  
                (unfold Î²[ Ïƒ' ]*=) â– 
                (congâŸ¨ _[ Ïƒ' ] âŸ© Î²) â– 
                (congâŸ¨ _[ Ïƒ' ] âŸ© (sym (unfold t[ âŸ¨ u âŸ© ]*=)))) ,=
               (refl) }
  ; Î·â€¢     = Î» { {Î“}{_}{A}{_}{B}{_}{t}{t[_]* , t[_]*=} â†’
             (funexti Î» Î”' â†’
              funext  Î» Ïƒ' â†’
              let Î·[_]*= = (Î» {Î”'' : Con} (Ïƒ'' : Sub Î”'' Î“) â†’
                            âŸª (congâŸ¨ lam âŸ© (sym $[])) â– 
                              (sym lam[]) â– 
                              (congâŸ¨ (Î» x â†’ lam (x $ q) [ Ïƒ'' ]) âŸ© (unfold t[ p ]*=)) âŸ«)
              in
              (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”}(Ïƒ : Sub Î” Î“) â†’ Lift ((v[ Ïƒ ]*) â‰¡ v [ Ïƒ ]))}
                                         (Î·)
                                         {(Î» {Î”} (Ïƒ : Sub Î” Î“) â†’ lam ((t[ p ]* [ Ïƒ âº ]) $ (q [ Ïƒ âº ]))) , Î·[_]*=}) Î”') Ïƒ') â– 
              (unfold Î·[ Ïƒ' ]*=) â– 
              (congâŸ¨ _[ Ïƒ' ] âŸ© Î·) â– 
              (sym (unfold t[ Ïƒ' ]*=))) ,=
             (refl)}
  ; lam[]â€¢ = Î» { {Î“}{_}{Î”}{_}{A}{_}{B}{_}{t}{t[_]* , t[_]*=}{Ïƒ}{_} â†’
               (funexti Î» Î”' â†’
                funext  Î» Ïƒ' â†’
                let lam[_]*= = (Î» {Î”'' : Con} (Ïƒ'' : Sub Î”'' Î”) â†’ âŸª (congâŸ¨ (Î» x â†’ lam x [ Ïƒ'' ]) âŸ© (unfold t[ Ïƒ âº ]*=)) â– 
                                                                    (congâŸ¨ _[ Ïƒ'' ] âŸ© (sym lam[])) âŸ«)
                in
                (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”''}(Ïƒ'' : Sub Î”'' Î”) â†’ Lift ((v[ Ïƒ'' ]*) â‰¡ v [ Ïƒ'' ]))}
                                         (lam[])
                                         {(Î» {Î”''} (Ïƒ'' : Sub Î”'' Î”) â†’ lam t[ Ïƒ âº ]* [ Ïƒ'' ]) , lam[_]*= }) Î”') Ïƒ') â– 
                (lam[])) ,=
               (refl)}
  ; $[]â€¢   = Î» { {Î“}{_}{Î”}{_}{A}{_}{B}{_}{t}{t[_]* , t[_]*=}{u}{u[_]* , u[_]*=}{Ïƒ}{_} â†’
               (funexti Î» Î”' â†’
                funext  Î» Ïƒ' â†’
                let $[_]*= = (Î» {Î”'' : Con} (Ïƒ'' : Sub Î”'' Î”) â†’ âŸª (congâŸ¨ (Î» x â†’ (x $ u[ Ïƒ ]*) [ Ïƒ'' ]) âŸ© (unfold t[ Ïƒ ]*=)) â– 
                                                                 (congâŸ¨ (Î» x â†’ ((t [ Ïƒ ]) $ x) [ Ïƒ'' ]) âŸ© (unfold u[ Ïƒ ]*=)) â– 
                                                                 (congâŸ¨ _[ Ïƒ'' ] âŸ© (sym $[])) âŸ«)
                in
                (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”''}(Ïƒ'' : Sub Î”'' Î”) â†’ Lift ((v[ Ïƒ'' ]*) â‰¡ v [ Ïƒ'' ]))}
                                         ($[])
                                         {(Î» {Î”''} (Ïƒ'' : Sub Î”'' Î”) â†’ (t[ Ïƒ ]* $ u[ Ïƒ ]*) [ Ïƒ'' ]) , $[_]*= }) Î”') Ïƒ') â– 
                ($[])) ,=
               (refl)}
  ; qâŸ¨âŸ©â€¢    = Î» { {Î“}{_}{A}{_}{u}{u[_]* , u[_]*=} â†’
               (funexti Î» Î”' â†’
                funext  Î» Ïƒ' â†’
                (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”}(Ïƒ : Sub Î” Î“) â†’ Lift ((v[ Ïƒ ]*) â‰¡ v [ Ïƒ ]))}
                                         (qâŸ¨âŸ©)
                                         {(Î» {Î”} (Ïƒ : Sub Î” Î“) â†’ (q [ âŸ¨ u âŸ© ]) [ Ïƒ ]) , (Î» {Î”} Ïƒ â†’ âŸª refl âŸ«)}) Î”') Ïƒ') â– 
               (congâŸ¨ _[ Ïƒ' ] âŸ© qâŸ¨âŸ©) â– 
               (sym (unfold u[ Ïƒ' ]*=))) ,=
               (refl)}
  ; q+â€¢    = Î» { {Î“}{_}{Î”}{_}{A}{_}{Ïƒ}{_} â†’
               (funexti Î» Î”' â†’
                funext  Î» Ïƒ' â†’
                (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”''}(Ïƒ'' : Sub Î”'' (Î” â–· A)) â†’ Lift ((v[ Ïƒ'' ]*) â‰¡ v [ Ïƒ'' ]))}
                                         (q+)
                                         {(Î» {Î”''} (Ïƒ'' : Sub Î”'' (Î” â–· A)) â†’ (q [ Ïƒ âº ]) [ Ïƒ'' ]) , (Î» {Î”''} Ïƒ'' â†’ âŸª refl âŸ«)}) Î”') Ïƒ') â– 
                (congâŸ¨ _[ Ïƒ' ] âŸ© q+)) ,=
               (refl)}
  ; pâŸ¨âŸ©â€¢    = Î» { {Î“}{_}{A}{_}{B}{_}{t}{t[_]* , t[_]*=}{u}{u[_]* , u[_]*=} â†’
               (funexti Î» Î”' â†’
                funext  Î» Ïƒ' â†’
                let pâŸ¨âŸ©[_]*= = (Î» {Î”''} (Ïƒ'' : Sub Î”'' Î“) â†’ âŸª congâŸ¨ (Î» x â†’ (x [ âŸ¨ u âŸ© ]) [ Ïƒ'' ]) âŸ© (unfold t[ p ]*=) âŸ«)
                in
                (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”''}(Ïƒ'' : Sub Î”'' Î“) â†’ Lift ((v[ Ïƒ'' ]*) â‰¡ v [ Ïƒ'' ]))}
                                         (pâŸ¨âŸ©)
                                         {(Î» {Î”''} (Ïƒ'' : Sub Î”'' Î“) â†’ (t[ p ]* [ âŸ¨ u âŸ© ]) [ Ïƒ'' ]) , pâŸ¨âŸ©[_]*= }) Î”') Ïƒ') â– 
                (unfold pâŸ¨âŸ©[ Ïƒ' ]*=) â– 
                (congâŸ¨ _[ Ïƒ' ] âŸ© pâŸ¨âŸ©) â– 
                (sym (unfold t[ Ïƒ' ]*=))) ,=
               (refl)}
  ; p+â€¢    = Î» { {Î“}{_}{Î”}{_}{A}{_}{B}{_}{Ïƒ}{_}{t}{t[_]* , t[_]*=} â†’
               let p+[_]*= = (Î» {Î”'} (Ïƒ' : Sub Î”' (Î” â–· B)) â†’ âŸª congâŸ¨ (Î» x â†’ (x [ Ïƒ âº ]) [ Ïƒ' ]) âŸ© (unfold t[ p ]*=) âŸ«)
               in
               (funexti Î» Î”' â†’
                funext  Î» Ïƒ' â†’
               (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                           {Î» v v[_]* â†’ (âˆ€{Î”''}(Ïƒ'' : Sub Î”'' (Î” â–· B)) â†’ Lift ((v[ Ïƒ'' ]*) â‰¡ v [ Ïƒ'' ]))}
                           (p+)
                           {(Î» {Î”''} (Ïƒ'' : Sub Î”'' (Î” â–· B)) â†’ (t[ p ]* [ Ïƒ âº ]) [ Ïƒ'' ]) , p+[_]*= }) Î”') Ïƒ') â– 
                (congâŸ¨ (Î» x â†’ (x [ Ïƒ âº ]) [ Ïƒ' ]) âŸ© (unfold t[ p ]*=)) â– 
                 (congâŸ¨ _[ Ïƒ' ] âŸ© p+) â– 
                 (congâŸ¨ (Î» x â†’ (x [ p ]) [ Ïƒ' ]) âŸ© (sym (unfold t[ Ïƒ ]*=)))) ,=
               (refl)}
  } where open I
module S = DepModel S

I* : Model
I* = record
   { Con   = I.Con
   ; Ty    = I.Ty
   ; Sub   = I.Sub
   ; Tm    = I.Tm
   ; â—‹     = I.â—‹ 
   ; _â–·_   = I._â–·_
   ; Î¹     = I.Î¹
   ; _â‡’_   = I._â‡’_
   ; p     = I.p
   ; âŸ¨_âŸ©    = I.âŸ¨_âŸ©
   ; _âº    = I._âº
   ; _[_]  = Î» t Ïƒ â†’ (prâ‚ S.âŸ¦ t âŸ§â€¢t) Ïƒ
   ; q     = I.q
   ; lam   = I.lam
   ; _$_   = I._$_
   ; Î²     = {!!}
   ; Î·     = {!!}
   ; lam[] = refl
   ; $[]   = refl
   ; qâŸ¨âŸ©    = {!!}
   ; q+    = {!!}
   ; pâŸ¨âŸ©    = {!!}
   ; p+    = {!!}
   }

\end{code}
