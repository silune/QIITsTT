\begin{code}

{-# OPTIONS --prop --rewriting #-}

open Agda.Primitive
open import Equality
open import Logic
open import Nat
open import TTSyntax

module TTStrictifiedSyntax where

-- We can define a more Strict Syntax where most of the equations are definitional

S : DepModel
S = record
  { Conâ€¢   = Î» _ â†’ ğŸ™
  ; Subâ€¢   = Î» _ _ _ â†’ ğŸ™
  ; Tyâ€¢    = Î» _ â†’ ğŸ™
  ; Tmâ€¢    = Î» {Î“} _ {A} _ t â†’ Î£ (âˆ€{Î”} â†’ (Ïƒ :  Sub Î” Î“) â†’ Tm Î” A)
                                (Î» t[_]* â†’ (âˆ€{Î”}(Ïƒ : Sub Î” Î“) â†’ Lift ((t[ Ïƒ ]*) â‰¡ t [ Ïƒ ])))
                                
  ; â—‹â€¢     = â˜…
  ; _â–·â€¢_   = Î» _ _ â†’ â˜…
  ; _âˆ˜â€¢_   = Î» _ _ â†’ â˜…
  ; idâ€¢    = â˜…
  ; Îµâ€¢     = â˜…
  ; _â€£â€¢_   = Î» _ _ â†’ â˜…
  ; pâ€¢     = â˜…
  ; Î¹â€¢     = â˜…
  ; _â‡’â€¢_   = Î» _ _ â†’ â˜…
  
  ; _[_]â€¢  = Î» { {Î“}{_}{Î”}{_}{A}{_}{t} (t[_]* , t[_]*=) {Ïƒ} _ â†’
               (Î» {Î”'} Ïƒ' â†’ t[ Ïƒ âˆ˜ Ïƒ' ]*) ,
               (Î» {Î”'} Ïƒ' â†’ âŸª (unfold (t[ Ïƒ âˆ˜ Ïƒ' ]*=)) â–  (sym [][]) âŸ«)}
  ; qâ€¢     = Î» { {Î“}{_}{A}{_} â†’
               (Î» {Î”'} Ïƒ' â†’ q [ Ïƒ' ]) ,
               (Î» {Î”'} Ïƒ' â†’ âŸª refl âŸ«)}
  ; lamâ€¢   = Î» { {Î“}{_}{A}{_}{B}{_}{t} (t[_]* , t[_]*=) â†’
               (Î» {Î”'} Ïƒ' â†’ lam (t[ Ïƒ' âˆ˜ p â€£ q ]*)) ,
               (Î» {Î”'} Ïƒ' â†’ âŸª (congâŸ¨ lam âŸ© (unfold t[ Ïƒ' âˆ˜ p â€£ q ]*=)) â–  (sym lam[]) âŸ«)}
  ; _$â€¢_   = Î» { {Î“}{_}{A}{_}{B}{_}{t} (t[_]* , t[_]*=) {u} (u[_]* , u[_]*=) â†’
               (Î» {Î”'} Ïƒ' â†’ t[ Ïƒ' ]* $ u[ Ïƒ' ]*) ,
               (Î» {Î”'} Ïƒ' â†’ âŸª (congâŸ¨ _$ u[ Ïƒ' ]* âŸ© (unfold t[ Ïƒ' ]*=)) â–  (congâŸ¨ (t [ Ïƒ' ])$_ âŸ© (unfold u[ Ïƒ' ]*=)) â–  (sym $[]) âŸ«)}
  
  ; Î²â€¢     =  Î» { {Î“}{_}{A}{_}{B}{_}{t}{t[_]* , t[_]*=}{u}{u[_]* , u[_]*=} â†’
               let Î²[_]*= = (Î» {Î”'' : Con} (Ïƒ'' : Sub Î”'' Î“) â†’
                             âŸª (congâŸ¨ (lam t[ Ïƒ'' âˆ˜ p â€£ q ]*) $_ âŸ© (unfold u[ Ïƒ'' ]*=)) â– 
                               (congâŸ¨ (Î» x â†’ (lam x) $ (u [ Ïƒ'' ])) âŸ© (unfold t[ Ïƒ'' âˆ˜ p â€£ q ]*=)) â– 
                               (congâŸ¨ _$ (u [ Ïƒ'' ]) âŸ© (sym lam[])) â– 
                               (sym $[]) âŸ«)
               in
               (funexti Î» Î”' â†’
                funext  Î» Ïƒ' â†’
                (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”}(Ïƒ : Sub Î” Î“) â†’ Lift ((v[ Ïƒ ]*) â‰¡ v [ Ïƒ ]))}
                                         (Î² {Î“}{A}{B}{t}{u})
                                         {(Î» {Î”} (Ïƒ : Sub Î” Î“) â†’ lam t[ Ïƒ âˆ˜ p â€£ q ]* $ u[ Ïƒ ]*) , Î²[_]*=}) Î”') Ïƒ') â– 
                (unfold Î²[ Ïƒ' ]*=) â– 
                (congâŸ¨ _[ Ïƒ' ] âŸ© Î²) â– 
                ([][]) â– 
                (sym (unfold t[ (id â€£ u) âˆ˜ Ïƒ' ]*=))) ,=
               (refl) }
  ; Î·â€¢     = Î» { {Î“}{_}{A}{_}{B}{_}{t}{t[_]* , t[_]*=} â†’
             (funexti Î» Î”' â†’
              funext  Î» Ïƒ' â†’
              let Î·[_]*= = (Î» {Î”'' : Con} (Ïƒ'' : Sub Î”'' Î“) â†’
                            âŸª (congâŸ¨ (Î» x â†’ lam (x $ (q [ Ïƒ'' âˆ˜ p â€£ q ]))) âŸ© (unfold t[ p âˆ˜ (Ïƒ'' âˆ˜ p â€£ q) ]*=)) â– 
                              (congâŸ¨ (Î» x â†’ lam (x $ (q [ Ïƒ'' âˆ˜ p â€£ q ]))) âŸ© (sym [][])) â– 
                              (congâŸ¨ lam âŸ© (sym $[])) â– 
                              (sym lam[]) âŸ«)
              in
              (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”}(Ïƒ : Sub Î” Î“) â†’ Lift ((v[ Ïƒ ]*) â‰¡ v [ Ïƒ ]))}
                                         (Î·)
                                         {(Î» {Î”} (Ïƒ : Sub Î” Î“) â†’ lam ((t[ p âˆ˜ (Ïƒ âˆ˜ p â€£ q) ]*) $ (q [ Ïƒ âˆ˜ p â€£ q ]))) , Î·[_]*=}) Î”') Ïƒ') â– 
              (unfold Î·[ Ïƒ' ]*=) â– 
              (congâŸ¨ _[ Ïƒ' ] âŸ© Î·) â– 
              (sym (unfold t[ Ïƒ' ]*=))) ,=
             (refl)}
  ; [][]â€¢  = Î» { {Î“}{_}{Î”}{_}{Î˜}{_}{A}{_}{t}{t[_]* , t[_]*=}{Ïƒ}{_}{Ï}{_} â†’
             ((funexti Î» Î”' â†’
              funext  Î» Ïƒ' â†’
              let [][_]*= = (Î» {Î”'' : Con} (Ïƒ'' : Sub Î”'' Î˜) â†’
                            âŸª (unfold t[ Ïƒ âˆ˜ Ï âˆ˜ Ïƒ'' ]*=) â– 
                              (sym [][]) â– 
                              (sym [][]) âŸ«)
              in
              (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”''} (Ïƒ'' : Sub Î”'' Î˜) â†’ Lift ((v[ Ïƒ'' ]*) â‰¡ v [ Ïƒ'' ]))}
                                         ([][])
                                         {(Î» {Î”''} (Ïƒ'' : Sub Î”'' Î˜) â†’ t[ Ïƒ âˆ˜ Ï âˆ˜ Ïƒ'' ]*) , [][_]*=}) Î”') Ïƒ') â– 
              (congâŸ¨ t[_]* âŸ© ass))) ,=
             (refl)}
  ; q[]â€¢   = Î» { {Î“}{_}{Î”}{_}{A}{_}{t}{t[_]* , t[_]*=}{Ïƒ}{_} â†’
               (
             ((funexti Î» Î”' â†’
              funext  Î» Ïƒ' â†’
              (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”''} (Ïƒ'' : Sub Î”'' Î”) â†’ Lift ((v[ Ïƒ'' ]*) â‰¡ v [ Ïƒ'' ]))}
                                         (q[])
                                         {(Î» {Î”''} (Ïƒ'' : Sub Î”'' Î”) â†’ q [ (Ïƒ â€£ t) âˆ˜ Ïƒ'' ]) , (Î» {Î”''} Ïƒ'' â†’ âŸª sym [][] âŸ«)}) Î”') Ïƒ') â– 
               (sym [][]) â– 
               (congâŸ¨ _[ Ïƒ' ] âŸ© q[]) â– 
               (sym (unfold t[ Ïƒ' ]*=))))) ,=
              (refl)}
  ; lam[]â€¢ = Î» { {Î“}{_}{Î”}{_}{A}{_}{B}{_}{t}{t[_]* , t[_]*=}{Ïƒ}{_} â†’
               (funexti Î» Î”' â†’
                funext  Î» Ïƒ' â†’
                let lam[_]*= = (Î» {Î”'' : Con} (Ïƒ'' : Sub Î”'' Î”) â†’
                               âŸª (congâŸ¨ lam âŸ© (unfold t[ (Ïƒ âˆ˜ Ïƒ'') âˆ˜ p â€£ q ]*=)) â– 
                                 (sym lam[]) â– 
                                 (sym [][]) âŸ«)
                in
                (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”''}(Ïƒ'' : Sub Î”'' Î”) â†’ Lift ((v[ Ïƒ'' ]*) â‰¡ v [ Ïƒ'' ]))}
                                         (lam[])
                                         {(Î» {Î”''} (Ïƒ'' : Sub Î”'' Î”) â†’ lam t[ (Ïƒ âˆ˜ Ïƒ'') âˆ˜ p â€£ q ]*) , lam[_]*= }) Î”') Ïƒ') â– 
                (unfold lam[ Ïƒ' ]*=) â– 
                (congâŸ¨ _[ Ïƒ' ] âŸ© lam[]) â– 
                (lam[]) â– 
                (congâŸ¨ lam âŸ© [][]) â– 
                (congâŸ¨ lam âŸ© (sym (unfold t[ (Ïƒ âˆ˜ p â€£ q) âˆ˜ (Ïƒ' âˆ˜ p â€£ q) ]*=)))) ,=
               (refl)}
  ; $[]â€¢   = Î» { {Î“}{_}{Î”}{_}{A}{_}{B}{_}{t}{t[_]* , t[_]*=}{u}{u[_]* , u[_]*=}{Ïƒ}{_} â†’
               (funexti Î» Î”' â†’
                funext  Î» Ïƒ' â†’
                let $[_]*= = (Î» {Î”'' : Con} (Ïƒ'' : Sub Î”'' Î”) â†’
                             âŸª (congâŸ¨ _$ u[ Ïƒ âˆ˜ Ïƒ'' ]* âŸ© (unfold t[ Ïƒ âˆ˜ Ïƒ'' ]*=)) â– 
                               (congâŸ¨ (t [ Ïƒ âˆ˜ Ïƒ'' ]) $_ âŸ© (unfold u[ Ïƒ âˆ˜ Ïƒ'' ]*=)) â– 
                               (sym $[]) â– 
                               (sym [][]) âŸ«)
                in
                (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”''}(Ïƒ'' : Sub Î”'' Î”) â†’ Lift ((v[ Ïƒ'' ]*) â‰¡ v [ Ïƒ'' ]))}
                                         ($[])
                                         {(Î» {Î”''} (Ïƒ'' : Sub Î”'' Î”) â†’ (t[ Ïƒ âˆ˜ Ïƒ'' ]* $ u[ Ïƒ âˆ˜ Ïƒ'' ]*)) , $[_]*= }) Î”') Ïƒ') â– 
                refl) ,=
               (refl)}
  ; t[id]â€¢ = Î» { {Î“}{_}{A}{_}{t}{t[_]* , t[_]*=} â†’
               ( (funexti Î» Î”' â†’
                funext  Î» Ïƒ' â†’
                let t[id][_]*= = (Î» {Î”'' : Con} (Ïƒ'' : Sub Î”'' Î“) â†’
                               âŸª (unfold t[ id âˆ˜ Ïƒ'' ]*=) â– 
                                 (sym [][]) âŸ«)
                in
                (cong$ (cong$i (transpÏ€â‚ {_}{_}{_}{_}{_}
                                         {Î» v v[_]* â†’ (âˆ€{Î”''}(Ïƒ'' : Sub Î”'' Î“) â†’ Lift ((v[ Ïƒ'' ]*) â‰¡ v [ Ïƒ'' ]))}
                                         (t[id])
                                         {(Î» {Î”''} (Ïƒ'' : Sub Î”'' Î“) â†’ t[ id âˆ˜ Ïƒ'' ]*) , t[id][_]*= }) Î”') Ïƒ') â– 
                (congâŸ¨ t[_]* âŸ© idl))) ,=
               (refl)}
  ; assâ€¢   = refl
  ; idlâ€¢   = Î» { {Ïƒâ€¢ = â˜…} â†’ refl }
  ; idrâ€¢   = Î» { {Ïƒâ€¢ = â˜…} â†’ refl }
  ; â—‹Î·â€¢    = Î» { {Ïƒâ€¢ = â˜…} â†’ refl }
  ; â–·Î²â€¢    = Î» { {Ïƒâ€¢ = â˜…} â†’ refl } 
  ; â–·Î·â€¢    = Î» { {Ïƒâ€¢ = â˜…} â†’ refl }
  } where open I
module S = DepModel S

I*Sub : I.Con â†’ I.Con â†’ Set
I*Sub Î” I.â—‹ = ğŸ™
I*Sub Î” (Î“ I.â–· A) = (I*Sub Î” Î“) Ã— (I.Tm Î” A)

I* : Model
I* = record
   { Con   = I.Con
   ; Ty    = I.Ty
   ; Sub   = I.Sub
   ; Tm    = I.Tm
   ; â—‹     = I.â—‹
   ; _â–·_   = I._â–·_
   ; Î¹     = I.Î¹
   ; _â‡’_   = I._â‡’_
   ; _âˆ˜_   = I._âˆ˜_
   ; id    = I.id
   ; Îµ     = I.Îµ
   ; _â€£_   = I._â€£_
   ; p     = I.p
   ; _[_]  = Î» t â†’ Ï€â‚ S.âŸ¦ t âŸ§â€¢t
   ; q     = I.q
   ; lam   = I.lam
   ; _$_   = I._$_
   ; Î²     = Î» {Î“}{A}{B}{t}{u} â†’ I.Î² â–  (sym (unfold (Ï€â‚‚ (S.âŸ¦ t âŸ§â€¢t) (I.id I.â€£ u))))
   ; Î·     = Î» {Î“}{A}{B}{t} â†’ (congâŸ¨ (Î» x â†’ I.lam (x I.$ I.q)) âŸ© (unfold (Ï€â‚‚ (S.âŸ¦ t âŸ§â€¢t) I.p))) â–  I.Î·
   ; [][]  = Î» {Î“}{Î”}{Î˜}{A}{t}{Ïƒ}{Ï} â†’ congâŸ¨ (Î» x â†’ Ï€â‚ S.âŸ¦ x âŸ§â€¢t Ï) âŸ© (unfold (Ï€â‚‚ S.âŸ¦ t âŸ§â€¢t Ïƒ))
   ; q[]   = I.q[]
   ; lam[] = refl
   ; $[]   = refl
   ; t[id] = Î» {Î“}{A}{t} â†’ (unfold (Ï€â‚‚ (S.âŸ¦ t âŸ§â€¢t) I.id)) â–  I.t[id] 
   ; ass   = I.ass
   ; idl   = I.idl
   ; idr   = I.idr
   ; â—‹Î·    = I.â—‹Î·
   ; â–·Î²    = I.â–·Î²
   ; â–·Î·    = I.â–·Î·
   }
module I* = Model I*

-- Then we need to show this is a syntax :

-- We already have that (I*.âŸ¦_âŸ§C , I*.âŸ¦_âŸ§S , I*.âŸ¦_âŸ§T , I*.âŸ¦_âŸ§t) are morphism from I to I*
-- Identity is a function from I* to I, we need to show it is a morphism, only terms are differents so :

[]*  : âˆ€{Î“ Î” : I*.Con}{A : I*.Ty}{t : I*.Tm Î“ A}{Ïƒ : I*.Sub Î” Î“} â†’
       t I*.[ Ïƒ ] â‰¡ t I.[ Ïƒ ]
[]* {Î“}{Î”}{A}{t}{Ïƒ} = unfold (Ï€â‚‚ S.âŸ¦ t âŸ§â€¢t Ïƒ)
q*   : âˆ€{Î“}{A} â†’ (I*.q {Î“}{A})  â‰¡ I.q
q*   = refl
lam* : âˆ€{Î“ : I*.Con}{A B : I*.Ty}{t : I*.Tm (Î“ I*.â–· A) B} â†’
       (I*.lam t) â‰¡ (I.lam t)
lam* = refl
$*   : âˆ€{Î“ : I*.Con}{A B : I*.Ty}{u : I*.Tm Î“ (A I*.â‡’ B)}{v : I*.Tm Î“ A} â†’
       u I*.$ v â‰¡ u I.$ v
$*   = refl

record DepModelS {lc}{ls}{lty}{ltm} : Set (lsuc (lc âŠ” ls âŠ” lty âŠ” ltm)) where

  infixr 6 _[_]â€¢
  infixr 7 _$â€¢_
  infixr 5 _â–·â€¢_
  infixr 6 _âˆ˜â€¢_
  infixr 5 _â€£â€¢_

  open I*

  field
  
    Conâ€¢   : Con â†’ Set lc
    Tyâ€¢    : Ty â†’ Set lty
    Subâ€¢   : âˆ€{Î”} â†’ Conâ€¢ Î” â†’ âˆ€{Î“} â†’ Conâ€¢ Î“ â†’ Sub Î” Î“ â†’ Set ls
    Tmâ€¢    : âˆ€{Î“} â†’ (Î“â€¢ : Conâ€¢ Î“) â†’ âˆ€{A} â†’ Tyâ€¢ A â†’ Tm Î“ A â†’ Set ltm
    
    â—‹â€¢     : Conâ€¢ â—‹
    _â–·â€¢_   : âˆ€{Î“} â†’ (Î“â€¢ : Conâ€¢ Î“) â†’ âˆ€{A} â†’ Tyâ€¢ A â†’ Conâ€¢ (Î“ â–· A) 

    _âˆ˜â€¢_   : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Î”}{Î”â€¢ : Conâ€¢ Î”}{Î˜}{Î˜â€¢ : Conâ€¢ Î˜}{Ïƒ} â†’ Subâ€¢ Î”â€¢ Î“â€¢ Ïƒ â†’ âˆ€{Ï} â†’ Subâ€¢ Î˜â€¢ Î”â€¢ Ï â†’ Subâ€¢ Î˜â€¢ Î“â€¢ (Ïƒ âˆ˜ Ï)
    idâ€¢    : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“} â†’ Subâ€¢ Î“â€¢ Î“â€¢ id
    Îµâ€¢     : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“} â†’ Subâ€¢ Î“â€¢ â—‹â€¢ Îµ
    _â€£â€¢_   : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Î”}{Î”â€¢ : Conâ€¢ Î”}{A}{Aâ€¢ : Tyâ€¢ A}{Ïƒ} â†’ Subâ€¢ Î”â€¢ Î“â€¢ Ïƒ â†’ âˆ€{t} â†’ Tmâ€¢ Î”â€¢ Aâ€¢ t â†’ Subâ€¢ Î”â€¢ (Î“â€¢ â–·â€¢ Aâ€¢) (Ïƒ â€£ t)
    pâ€¢     : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{A}{Aâ€¢ : Tyâ€¢ A} â†’ Subâ€¢ (Î“â€¢ â–·â€¢ Aâ€¢) Î“â€¢ p

    Î¹â€¢     : Tyâ€¢ I.Î¹
    _â‡’â€¢_   : âˆ€{A}{B} â†’ Tyâ€¢ A â†’ Tyâ€¢ B â†’ Tyâ€¢ (A I.â‡’ B)

    _[_]â€¢  : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Î”}{Î”â€¢ : Conâ€¢ Î”}{A}{Aâ€¢ : Tyâ€¢ A}{u} â†’ Tmâ€¢ Î“â€¢ Aâ€¢ u â†’ âˆ€{Ïƒ} â†’ (Ïƒâ€¢ : Subâ€¢ Î”â€¢ Î“â€¢ Ïƒ) â†’
             Tmâ€¢ Î”â€¢ Aâ€¢ (u [ Ïƒ ])
    qâ€¢     : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{A}{Aâ€¢ : Tyâ€¢ A} â†’
             Tmâ€¢ (Î“â€¢ â–·â€¢ Aâ€¢) Aâ€¢ q
    lamâ€¢   : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{A}{Aâ€¢ : Tyâ€¢ A}{B}{Bâ€¢ : Tyâ€¢ B}{t} â†’ Tmâ€¢ (Î“â€¢ â–·â€¢ Aâ€¢) Bâ€¢ t â†’
             Tmâ€¢ Î“â€¢ (Aâ€¢ â‡’â€¢ Bâ€¢) (lam t)
    _$â€¢_   : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{A}{Aâ€¢ : Tyâ€¢ A}{B}{Bâ€¢ : Tyâ€¢ B}{t} â†’ Tmâ€¢ Î“â€¢ (Aâ€¢ â‡’â€¢ Bâ€¢) t â†’ âˆ€{u} â†’ Tmâ€¢ Î“â€¢ Aâ€¢ u â†’
             Tmâ€¢ Î“â€¢ Bâ€¢ (t $ u)

    Î²â€¢     : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{A}{Aâ€¢ : Tyâ€¢ A}{B}{Bâ€¢ : Tyâ€¢ B}{t}{tâ€¢ : Tmâ€¢ (Î“â€¢ â–·â€¢ Aâ€¢) Bâ€¢ t}{u}{uâ€¢ : Tmâ€¢ Î“â€¢ Aâ€¢ u} â†’
             transpâŸ¨ Tmâ€¢ Î“â€¢ Bâ€¢ âŸ© Î² ((lamâ€¢ tâ€¢) $â€¢ uâ€¢) â‰¡ tâ€¢ [ idâ€¢ â€£â€¢ uâ€¢ ]â€¢
    Î·â€¢     : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{A}{Aâ€¢ : Tyâ€¢ A}{B}{Bâ€¢ : Tyâ€¢ B}{t}{tâ€¢ : Tmâ€¢ Î“â€¢ (Aâ€¢ â‡’â€¢ Bâ€¢) t} â†’
             transpâŸ¨ Tmâ€¢ Î“â€¢ (Aâ€¢ â‡’â€¢ Bâ€¢) âŸ© Î· (lamâ€¢ ((tâ€¢ [ pâ€¢ ]â€¢) $â€¢ qâ€¢)) â‰¡ tâ€¢
    [][]â€¢  : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Î”}{Î”â€¢ : Conâ€¢ Î”}{Î˜}{Î˜â€¢ : Conâ€¢ Î˜}{A}{Aâ€¢ : Tyâ€¢ A}{t}{tâ€¢ : Tmâ€¢ Î“â€¢ Aâ€¢ t}{Ïƒ}{Ïƒâ€¢ : Subâ€¢ Î”â€¢ Î“â€¢ Ïƒ}{Ï}{Ïâ€¢ : Subâ€¢ Î˜â€¢ Î”â€¢ Ï} â†’
             transpâŸ¨ Tmâ€¢ Î˜â€¢ Aâ€¢ âŸ© ([][] {Î“}{Î”}{Î˜}{A}{t}{Ïƒ}{Ï}) (tâ€¢ [ Ïƒâ€¢ ]â€¢ [ Ïâ€¢ ]â€¢) â‰¡ tâ€¢ [ Ïƒâ€¢ âˆ˜â€¢ Ïâ€¢ ]â€¢
    q[]â€¢   : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Î”}{Î”â€¢ : Conâ€¢ Î”}{A}{Aâ€¢ : Tyâ€¢ A}{t}{tâ€¢ : Tmâ€¢ Î”â€¢ Aâ€¢ t}{Ïƒ}{Ïƒâ€¢ : Subâ€¢ Î”â€¢ Î“â€¢ Ïƒ} â†’
             transpâŸ¨ Tmâ€¢ Î”â€¢ Aâ€¢ âŸ© q[] (qâ€¢ [ Ïƒâ€¢ â€£â€¢ tâ€¢ ]â€¢) â‰¡ tâ€¢
    lam[]â€¢ : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Î”}{Î”â€¢ : Conâ€¢ Î”}{A}{Aâ€¢ : Tyâ€¢ A}{B}{Bâ€¢ : Tyâ€¢ B}{t}{tâ€¢ : Tmâ€¢ (Î“â€¢ â–·â€¢ Aâ€¢) Bâ€¢ t}{Ïƒ}{Ïƒâ€¢ : Subâ€¢ Î”â€¢ Î“â€¢ Ïƒ} â†’
             (lamâ€¢ tâ€¢) [ Ïƒâ€¢ ]â€¢ â‰¡ lamâ€¢ (tâ€¢ [ Ïƒâ€¢ âˆ˜â€¢ pâ€¢ â€£â€¢ qâ€¢ ]â€¢)
    $[]â€¢   : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Î”}{Î”â€¢ : Conâ€¢ Î”}{A}{Aâ€¢ : Tyâ€¢ A}{B}{Bâ€¢ : Tyâ€¢ B}{t}{tâ€¢ : Tmâ€¢ Î“â€¢ (Aâ€¢ â‡’â€¢ Bâ€¢) t}
             {u}{uâ€¢ : Tmâ€¢ Î“â€¢ Aâ€¢ u}{Ïƒ}{Ïƒâ€¢ : Subâ€¢ Î”â€¢ Î“â€¢ Ïƒ} â†’
             (tâ€¢ $â€¢ uâ€¢) [ Ïƒâ€¢ ]â€¢ â‰¡ (tâ€¢ [ Ïƒâ€¢ ]â€¢) $â€¢ (uâ€¢ [ Ïƒâ€¢ ]â€¢)
    t[id]â€¢ : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{A}{Aâ€¢ : Tyâ€¢ A}{t}{tâ€¢ : Tmâ€¢ Î“â€¢ Aâ€¢ t} â†’
             transpâŸ¨ Tmâ€¢ Î“â€¢ Aâ€¢ âŸ© t[id] (tâ€¢ [ idâ€¢ ]â€¢) â‰¡ tâ€¢
    assâ€¢   : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Î”}{Î”â€¢ : Conâ€¢ Î”}{Î˜}{Î˜â€¢ : Conâ€¢ Î˜}{Î©}{Î©â€¢ : Conâ€¢ Î©}
             {Ïƒ}{Ïƒâ€¢ : Subâ€¢ Î”â€¢ Î“â€¢ Ïƒ}{Ï}{Ïâ€¢ : Subâ€¢ Î˜â€¢ Î”â€¢ Ï}{Î³}{Î³â€¢ : Subâ€¢ Î©â€¢ Î˜â€¢ Î³} â†’
             transpâŸ¨ Subâ€¢ Î©â€¢ Î“â€¢ âŸ© ass (Ïƒâ€¢ âˆ˜â€¢ (Ïâ€¢ âˆ˜â€¢ Î³â€¢)) â‰¡ (Ïƒâ€¢ âˆ˜â€¢ Ïâ€¢) âˆ˜â€¢ Î³â€¢
    idlâ€¢   : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Î”}{Î”â€¢ : Conâ€¢ Î”}{Ïƒ}{Ïƒâ€¢ : Subâ€¢ Î”â€¢ Î“â€¢ Ïƒ} â†’
             transpâŸ¨ Subâ€¢ Î”â€¢ Î“â€¢ âŸ© idl (idâ€¢ âˆ˜â€¢ Ïƒâ€¢) â‰¡ Ïƒâ€¢
    idrâ€¢   : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Î”}{Î”â€¢ : Conâ€¢ Î”}{Ïƒ}{Ïƒâ€¢ : Subâ€¢ Î”â€¢ Î“â€¢ Ïƒ} â†’
             transpâŸ¨ Subâ€¢ Î”â€¢ Î“â€¢ âŸ© idr (Ïƒâ€¢ âˆ˜â€¢ idâ€¢) â‰¡ Ïƒâ€¢
    â—‹Î·â€¢    : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Ïƒ}{Ïƒâ€¢ : Subâ€¢ Î“â€¢ â—‹â€¢ Ïƒ} â†’
             transpâŸ¨ Subâ€¢ Î“â€¢ â—‹â€¢ âŸ© â—‹Î· Ïƒâ€¢ â‰¡ Îµâ€¢
    â–·Î²â€¢    : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Î”}{Î”â€¢ : Conâ€¢ Î”}{A}{Aâ€¢ : Tyâ€¢ A}{Ïƒ}{Ïƒâ€¢ : Subâ€¢ Î”â€¢ Î“â€¢ Ïƒ}{t}{tâ€¢ : Tmâ€¢ Î”â€¢ Aâ€¢ t} â†’
             transpâŸ¨ Subâ€¢ Î”â€¢ Î“â€¢ âŸ© â–·Î² (pâ€¢ âˆ˜â€¢ (Ïƒâ€¢ â€£â€¢ tâ€¢)) â‰¡ Ïƒâ€¢
    â–·Î·â€¢    : âˆ€{Î“}{Î“â€¢ : Conâ€¢ Î“}{Î”}{Î”â€¢ : Conâ€¢ Î”}{A}{Aâ€¢ : Tyâ€¢ A}{Ïƒ}{Ïƒâ€¢ : Subâ€¢ Î”â€¢ (Î“â€¢ â–·â€¢ Aâ€¢) Ïƒ} â†’
             transpâŸ¨ Subâ€¢ Î”â€¢ (Î“â€¢ â–·â€¢ Aâ€¢) âŸ© â–·Î· (pâ€¢ âˆ˜â€¢ Ïƒâ€¢ â€£â€¢ qâ€¢ [ Ïƒâ€¢ ]â€¢) â‰¡ Ïƒâ€¢
 
  DMeq : DepModel
  DMeq = record
       { Conâ€¢ = Conâ€¢ ; â—‹â€¢ = â—‹â€¢ ; _â–·â€¢_ = _â–·â€¢_
       ; Subâ€¢ = Subâ€¢ ; _âˆ˜â€¢_ = _âˆ˜â€¢_ ; idâ€¢ = idâ€¢ ; Îµâ€¢ = Îµâ€¢ ; _â€£â€¢_ = _â€£â€¢_ ; pâ€¢ = pâ€¢
       ; Tyâ€¢ = Tyâ€¢ ; Î¹â€¢ = Î¹â€¢ ; _â‡’â€¢_ = _â‡’â€¢_
       ; Tmâ€¢ = Tmâ€¢
       ; _[_]â€¢ = Î» {Î“}{Î“â€¢}{Î”}{Î”â€¢}{A}{Aâ€¢}{t} tâ€¢ {Ïƒ} Ïƒâ€¢ â†’
                 transpâŸ¨ Tmâ€¢ Î”â€¢ Aâ€¢ âŸ© ([]*) (tâ€¢ [ Ïƒâ€¢ ]â€¢)
       ; qâ€¢ = qâ€¢ ; lamâ€¢ = lamâ€¢ ; _$â€¢_ = _$â€¢_
       ; Î²â€¢     = Î» {Î“}{Î“â€¢}{A}{Aâ€¢}{B}{Bâ€¢}{t}{tâ€¢}{u}{uâ€¢} â†’
                  (sym (transptransp (Tmâ€¢ Î“â€¢ Bâ€¢) Î² []*)) â–  (congâŸ¨ transpâŸ¨ Tmâ€¢ Î“â€¢ Bâ€¢ âŸ© []* âŸ© Î²â€¢)
       ; Î·â€¢     = Î» {Î“}{Î“â€¢}{A}{Aâ€¢}{B}{Bâ€¢}{t}{tâ€¢} â†’
                  (congâŸ¨ transpâŸ¨ Tmâ€¢ Î“â€¢ (Aâ€¢ â‡’â€¢ Bâ€¢) âŸ© I.Î· âŸ©
                     (transp$ (Î» x (xâ€¢ : Tmâ€¢ (Î“â€¢ â–·â€¢ Aâ€¢) (Aâ€¢ â‡’â€¢ Bâ€¢) x) â†’ lamâ€¢ (xâ€¢ $â€¢ qâ€¢)) []*)) â– 
                  (transptransp (Tmâ€¢ Î“â€¢ (Aâ€¢ â‡’â€¢ Bâ€¢)) (congâŸ¨ (Î» x â†’ lam (x $ q)) âŸ© []*) I.Î·) â– 
                  (Î·â€¢)
       ; [][]â€¢  = Î» {Î“}{Î“â€¢}{Î”}{Î”â€¢}{Î˜}{Î˜â€¢}{A}{Aâ€¢}{t}{tâ€¢}{Ïƒ}{Ïƒâ€¢}{Ï}{Ïâ€¢} â†’
                  (congâŸ¨ (Î» x â†’ transpâŸ¨ Tmâ€¢ Î˜â€¢ Aâ€¢ âŸ© I.[][] (transpâŸ¨ Tmâ€¢ Î˜â€¢ Aâ€¢ âŸ© []* x)) âŸ©
                      (transp$ (Î» x (xâ€¢ : Tmâ€¢ Î”â€¢ Aâ€¢ x) â†’ xâ€¢ [ Ïâ€¢ ]â€¢) []*)) â– 
                  (transptransp (Tmâ€¢ Î˜â€¢ Aâ€¢) []* I.[][]) â– 
                  (transptransp (Tmâ€¢ Î˜â€¢ Aâ€¢) (congâŸ¨ (Î» x â†’ x [ Ï ]) âŸ© ([]* {Î“}{Î”}{A}{t}{Ïƒ})) ([]* â–  I.[][])) â– 
                  (sym (transptransp (Tmâ€¢ Î˜â€¢ Aâ€¢) ([][] {Î“}{Î”}{Î˜}{A}{t}{Ïƒ}{Ï}) []*)) â– 
                  (congâŸ¨ transpâŸ¨ Tmâ€¢ Î˜â€¢ Aâ€¢ âŸ© []* âŸ© [][]â€¢)
       ; q[]â€¢   = q[]â€¢
       ; lam[]â€¢ = Î» {Î“}{Î“â€¢}{Î”}{Î”â€¢}{A}{Aâ€¢}{B}{Bâ€¢}{t}{tâ€¢}{Ïƒ}{Ïƒâ€¢} â†’
                  {!!}
       ; $[]â€¢   = {!!}
       ; t[id]â€¢ = {!!}
       ; assâ€¢ = assâ€¢ ; idlâ€¢ = idlâ€¢ ; idrâ€¢ = idrâ€¢ ; â—‹Î·â€¢ = â—‹Î·â€¢ ; â–·Î²â€¢ = â–·Î²â€¢ ; â–·Î·â€¢ = â–·Î·â€¢
       }
